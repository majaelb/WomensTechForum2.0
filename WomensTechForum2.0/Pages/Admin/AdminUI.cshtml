@page
@*@using Microsoft.AspNetCore.Identity;*@
@model WomensTechForum2._0.Pages.Admin.AdminUIModel
@*@inject UserManager<IdentityUser> UserManager
*@@{
    //var users = UserManager.Users.ToList();
}
<h2>Anmälda original-inlägg</h2>
<table class="table table-striped table-hover">
    <tr>
        <th>Användare</th>
        <th>Datum</th>
        <th>Rubrik</th>
        <th>Text</th>
        <th>Antal anmälningar</th>
        <th>Bild</th>
        <th>Ändra</th>
        <th>Ta bort</th>
    </tr>
    @foreach (var post in Model.ReportedPosts)
    {
        <tr>
            <td>@Model.Users.FirstOrDefault(u => u.Id == post.UserId).UserName</td>
            <td>@post.Date</td>
            <td>@post.Header</td>
            <td>@post.Text</td>
            <td>@post.NoOfReports</td>
            @if (post.ImageSrc != null && post.ImageSrc.Any())
            {
                <td><img src="~/img/@post.ImageSrc" height="50" /></td>
            }
            else
            {
                <td> </td>
            }
            <td>
                <a asp-route-changeId="@post.Id">Markera som ej stötande</a>
            </td>
            <td><a asp-route-deleteId="@post.Id">Stötande inlägg - Radera</a></td>
        </tr>

        @*
    asp-page="./OffensivePosts/Edit"
    asp-page="./OffensivePosts/Delete"*@
    }

</table>
<h2>Anmälda kommentars-inlägg</h2>
<table class="table table-striped table-hover">
    <tr>
        <th>Användare</th>
        <th>Datum</th>
        <th>Text</th>
        <th>Antal anmälningar</th>
        <th>Bild</th>
        <th>Ändra</th>
        <th>Ta bort</th>
    </tr>
    @foreach (var post in Model.ReportedPostThreads)
    {
        <tr>
            <td>@Model.Users.FirstOrDefault(u => u.Id == post.UserId).UserName</td>
            <td>@post.Date</td>
            <td>@post.Text</td>
            <td>@post.NoOfReports</td>
            @if (post.ImageSrc != null && post.ImageSrc.Any())
            {
                <td><img src="~/img/@post.ImageSrc" height="50" /></td>
            }
            else
            {
                <td> </td>
            }
            <td><a asp-route-changePTId="@post.Id">Markera som ej stötande</a></td>
            <td><a asp-route-deletePTId="@post.Id">Stötande inlägg - Radera</a></td>
        </tr>
    }

</table>

<h2>Redigera huvudkategorier</h2>
<table class="table table-striped table-hover">
    <tr>
        <th>Namn</th>
        <th></th>
        <th></th>
    </tr>
@foreach(var cat in Model.MainCategories)
{
    <tr>

    <td><p>@cat.Name</p></td>
    <td><a asp-route-changeMainCatId="@cat.Id" class="btn btn-primary">Ändra</a></td>
    <td><a asp-route-deleteMainCatId="@cat.Id" class="btn btn-danger">Ta bort</a></td>
    </tr>
}
</table>
<h2>Lägg till en huvudkategori</h2>
<form method="post">
    <input asp-for="NewMainCategory.Id" type="hidden" />
    <label asp-for="NewMainCategory.Name" class="form-label"></label>
    <input asp-for="NewMainCategory.Name" class="form-control" placeholder="Ange namn på huvudkategori" />
    <input type="submit" class="btn btn-secondary" value="Lägg till/spara"/>

</form>
<hr />
<h2>Redigera subkategorier</h2>
<table class="table table-striped table-hover">
    <tr>
        <th>Namn</th>
        <th>Huvudkategori</th>
        <th>Beskrivning</th>
        <th></th>
        <th></th>
    </tr>
    @foreach (var cat in Model.SubCategories)
    {
        var mainCat = Model.MainCategories.Where(c => c.Id == cat.MainCategoryId).FirstOrDefault();

        <tr>

            <td>@cat.Name</td>
            <td>@mainCat.Name</td>
            <td>@cat.Description</td>
            <td><a asp-route-changeSubCatId="@cat.Id" class="btn btn-primary">Ändra</a></td>
            <td><a asp-route-deleteSubCatId="@cat.Id" class="btn btn-danger">Ta bort</a></td>
        </tr>
    }
</table>
<h2>Lägg till en subkategori</h2>
<form method="post">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <div class="form-group">
        <input asp-for="NewSubCategory.Id" type="hidden" />
        <label asp-for="NewSubCategory.Name" class="control-label"></label>
        <input asp-for="NewSubCategory.Name" class="form-control" />
        <span asp-validation-for="NewSubCategory.Name" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="NewSubCategory.Description" class="control-label"></label>
        <input asp-for="NewSubCategory.Description" class="form-control" />
        <span asp-validation-for="NewSubCategory.Description" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="NewSubCategory.MainCategoryId" class="control-label"></label>
        <select asp-for="NewSubCategory.MainCategoryId" class="form-control" asp-items="ViewBag.MainCategoryId"></select>
    </div>
    <div class="form-group">
        <input type="submit" value="Lägg till/spara" class="btn btn-secondary" asp-page-handler="SubCategory"/>
    </div>
</form>
@*<form method="post">
    <input asp-for="NewSubCategory.Id" type="hidden" />
    <label asp-for="NewSubCategory.Name" class="form-label"></label>
    <input asp-for="NewSubCategory.Name" class="form-control" placeholder="Ange namn på subkategori" />
    <input type="submit" class="btn btn-secondary" value="Lägg till/spara" />
</form>*@